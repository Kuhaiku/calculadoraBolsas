<!DOCTYPE html>
<html lang="pt-BR" class="light">
<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Calculadora 2.0 (Otimizada)</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
    
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#137fec",
                        
                        "background-light": "#F9F9F9",
                        "background-dark": "#101922",
                        
                        "card-light": "#FFFFFF",
                        "card-dark": "#192734",
                        
                        "surface-light": "#ffffff",
                        "surface-dark": "#1a2530",

                        "text-light": "#111418",
                        "text-dark": "#F6F7F8",
                        "text-light-primary": "#111418",
                        "text-dark-primary": "#f0f2f4",
                        
                        "text-secondary-light": "#617589",
                        "text-secondary-dark": "#9DAAB6",
                        "text-light-secondary": "#617589",
                        "text-dark-secondary": "#a0b3c6",

                        "border-light": "#dbe0e6",
                        "border-dark": "#34404C",
                        "border-dark-nav": "#344455",
                    },
                    fontFamily: {
                        "display": ["Inter", "sans-serif"]
                    },
                    borderRadius: {
                        "DEFAULT": "0.5rem",
                        "lg": "0.75rem",
                        "xl": "1rem",
                        "full": "9999px"
                    },
                },
            },
        }
    </script>
    <style>
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }
        .material-symbols-outlined.filled,
        .material-symbols-outlined.fill {
            font-variation-settings: 'FILL' 1, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }
        body {
            min-height: max(884px, 100dvh);
        }
        /* Classe helper para esconder abas */
        .tab-panel.hidden,
        .input-conditional.hidden {
            display: none;
        }
        
        /* (NOVO) Estilos para visualização do corte */
        .visual-fabric {
            position: relative;
            width: 100%;
            height: 80px; /* Altura fixa para o visual */
            background-color: #e5e7eb; /* bg-slate-200 */
            border: 1px solid #d1d5db; /* border-slate-300 */
            border-radius: 0.25rem; /* rounded-sm */
            overflow: hidden;
            display: flex; /* Usar flex para alinhar as peças */
            align-items: center; /* Centralizar verticalmente */
            padding: 4px; /* Pequeno padding */
            gap: 4px; /* Espaço entre as peças */
        }
        .dark .visual-fabric {
            background-color: #334155; /* dark:bg-slate-700 */
            border-color: #475569; /* dark:border-slate-600 */
        }
        .visual-piece {
            height: 90%; /* Ocupa a maior parte da altura */
            background-color: #60a5fa; /* bg-blue-400 */
            border: 1px solid #2563eb; /* border-blue-600 */
            opacity: 0.8;
            flex-shrink: 0; /* Impede que a peça encolha */
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            color: #1e3a8a;
            font-weight: 500;
            overflow: hidden;
            writing-mode: vertical-rl; /* Escreve o texto na vertical */
            text-orientation: mixed;
        }
    </style>
</head>

<body class="light">
    <div class="relative flex min-h-screen w-full flex-col bg-background-light dark:bg-background-dark font-display text-text-light dark:text-text-dark">
        
        <header class="sticky top-0 z-10 flex h-16 items-center border-b border-border-light/80 bg-background-light/80 dark:border-border-dark/80 dark:bg-background-dark/80 px-4 backdrop-blur-sm">
            <h1 id="header-title" class="flex-1 text-center text-lg font-bold leading-tight tracking-[-0.015em] text-text-light dark:text-text-dark">
                Custos de Insumos
            </h1>
        </header>

        <main class="flex-1 pb-28">
            
            <div id="tab-insumos" class="tab-panel px-4 py-6">
                <div class="flex flex-col gap-6">
                    <div class="rounded-xl bg-card-light dark:bg-card-dark p-5 shadow-[0_4px_12px_rgba(0,0,0,0.05)] dark:shadow-[0_4px_12px_rgba(0,0,0,0.1)]">
                        <h2 class="text-text-light dark:text-text-dark text-[22px] font-bold leading-tight tracking-[-0.015em] mb-4">Materiais Principais</h2>
                        
                        <h3 class="text-text-secondary-light dark:text-text-secondary-dark text-sm font-semibold uppercase tracking-wider mb-2 mt-4">Alça</h3>
                        <div class="flex flex-col gap-4">
                            <label class="flex flex-col">
                                <p class="text-base font-medium leading-normal pb-2 text-text-light dark:text-text-dark">Preço por Metro (R$)</p>
                                <input id="precoAlca" class="form-input h-14 w-full ... " inputmode="decimal" placeholder="0,00" type="number" value="2" oninput="calcularTudo()">
                            </label>
                            <label class="flex flex-col">
                                <p class="text-base font-medium leading-normal pb-2 text-text-light dark:text-text-dark">Cm por Bolsa (cm)</p>
                                <input id="cmAlca" class="form-input h-14 w-full ... " inputmode="numeric" placeholder="0" type="number" value="120" oninput="calcularTudo()">
                            </label>
                        </div>
                        
                        <h3 class="text-text-secondary-light dark:text-text-secondary-dark text-sm font-semibold uppercase tracking-wider mb-2 mt-6">TNT</h3>
                        <div class="flex flex-col gap-4">
                            <label class="flex flex-col">
                                <p class="text-base font-medium leading-normal pb-2 text-text-light dark:text-text-dark">Preço por Metro (R$)</p>
                                <input id="precoTNT" class="form-input h-14 w-full ... " inputmode="decimal" placeholder="0,00" type="number" value="5" oninput="calcularTudo()">
                            </label>
                            <label class="flex flex-col">
                                <p class="text-base font-medium leading-normal pb-2 text-text-light dark:text-text-dark">Largura do Tecido (cm)</p>
                                <input id="larguraTNT" class="form-input h-14 w-full ... " inputmode="numeric" placeholder="0" type="number" value="140" oninput="calcularTudo()">
                            </label>
                            <div class="grid grid-cols-2 gap-4">
                                <label class="flex flex-col">
                                    <p class="text-base font-medium leading-normal pb-2 text-text-light dark:text-text-dark">Altura da Peça (cm)</p>
                                    <input id="alturaPecaTNT" class="form-input h-14 w-full ... " inputmode="numeric" placeholder="0" type="number" value="90" oninput="calcularTudo()">
                                </label>
                                <label class="flex flex-col">
                                    <p class="text-base font-medium leading-normal pb-2 text-text-light dark:text-text-dark">Largura da Peça (cm)</p>
                                    <input id="larguraPecaTNT" class="form-input h-14 w-full ... " inputmode="numeric" placeholder="0" type="number" value="45" oninput="calcularTudo()">
                                </label>
                            </div>
                        </div>
                        
                        <h3 class="text-text-secondary-light dark:text-text-secondary-dark text-sm font-semibold uppercase tracking-wider mb-2 mt-6">Algodão</h3>
                        <div class="flex flex-col gap-4">
                            <label class="flex flex-col">
                                <p class="text-base font-medium leading-normal pb-2 text-text-light dark:text-text-dark">Preço por Metro (R$)</p>
                                <input id="precoAlgodao" class="form-input h-14 w-full ... " inputmode="decimal" placeholder="0,00" type="number" value="23.90" oninput="calcularTudo()">
                            </label>
                            <label class="flex flex-col">
                                <p class="text-base font-medium leading-normal pb-2 text-text-light dark:text-text-dark">Largura do Tecido (cm)</p>
                                <input id="larguraAlgodao" class="form-input h-14 w-full ... " inputmode="numeric" placeholder="0" type="number" value="180" oninput="calcularTudo()">
                            </label>
                            <div class="grid grid-cols-2 gap-4">
                                <label class="flex flex-col">
                                    <p class="text-base font-medium leading-normal pb-2 text-text-light dark:text-text-dark">Altura da Peça (cm)</p>
                                    <input id="alturaPecaAlgodao" class="form-input h-14 w-full ... " inputmode="numeric" placeholder="0" type="number" value="90" oninput="calcularTudo()">
                                </label>
                                <label class="flex flex-col">
                                    <p class="text-base font-medium leading-normal pb-2 text-text-light dark:text-text-dark">Largura da Peça (cm)</p>
                                    <input id="larguraPecaAlgodao" class="form-input h-14 w-full ... " inputmode="numeric" placeholder="0" type="number" value="45" oninput="calcularTudo()">
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="rounded-xl bg-card-light dark:bg-card-dark p-5 shadow-[0_4px_12px_rgba(0,0,0,0.05)] dark:shadow-[0_4px_12px_rgba(0,0,0,0.1)]">
                        <h2 class="text-text-light dark:text-text-dark text-[22px] font-bold leading-tight tracking-[-0.015em] mb-4">Custos Adicionais</h2>
                        
                        <h3 class="text-text-secondary-light dark:text-text-secondary-dark text-sm font-semibold uppercase tracking-wider mb-2 mt-4">Custos Variáveis (por bolsa)</h3>
                        <div class="grid grid-cols-3 gap-4">
                            <label class="flex flex-col">
                                <p class="text-base font-medium leading-normal pb-2 text-text-light dark:text-text-dark">Etiqueta (R$)</p>
                                <input id="precoEtiqueta" class="form-input h-14 w-full ... " inputmode="decimal" placeholder="0,00" type="number" value="0" oninput="calcularTudo()">
                            </label>
                            <label class="flex flex-col">
                                <p class="text-base font-medium leading-normal pb-2 text-text-light dark:text-text-dark">Embalag. (R$)</p>
                                <input id="precoEmbalagem" class="form-input h-14 w-full ... " inputmode="decimal" placeholder="0,00" type="number" value="0" oninput="calcularTudo()">
                            </label>
                            <label class="flex flex-col">
                                <p class="text-base font-medium leading-normal pb-2 text-text-light dark:text-text-dark">Tinta (R$)</p>
                                <input id="precoTinta" class="form-input h-14 w-full ... " inputmode="decimal" placeholder="0,00" type="number" value="0" oninput="calcularTudo()">
                            </label>
                        </div>
                        
                        <h3 class="text-text-secondary-light dark:text-text-secondary-dark text-sm font-semibold uppercase tracking-wider mb-2 mt-6">Mão de Obra (por bolsa)</h3>
                        <div class="flex flex-col gap-4">
                            <label class="flex flex-col">
                                <p class="text-base font-medium leading-normal pb-2 text-text-light dark:text-text-dark">Tipo de Cálculo</p>
                                <select id="tipoCalculoMaoDeObra" class="form-select h-14 w-full ... " onchange="atualizarVisibilidadeMaoDeObra()">
                                    <option value="fixo">Valor Fixo por Bolsa</option>
                                    <option value="hora">Valor por Hora</option>
                                </select>
                            </label>
                            
                            <label id="div-mao-obra-fixo" class="flex flex-col input-conditional">
                                <p class="text-base font-medium leading-normal pb-2 text-text-light dark:text-text-dark">Valor Fixo por Bolsa (R$)</p>
                                <input id="maoDeObraFixo" class="form-input h-14 w-full ... " inputmode="decimal" placeholder="0,00" type="number" value="0" oninput="calcularTudo()">
                            </label>
                            
                            <div id="div-mao-obra-hora" class="grid grid-cols-2 gap-4 input-conditional hidden">
                                <label class="flex flex-col">
                                    <p class="text-base font-medium leading-normal pb-2 text-text-light dark:text-text-dark">Valor da Hora (R$)</p>
                                    <input id="maoDeObraValorHora" class="form-input h-14 w-full ... " inputmode="decimal" placeholder="0,00" type="number" value="0" oninput="calcularTudo()">
                                </label>
                                <label class="flex flex-col">
                                    <p class="text-base font-medium leading-normal pb-2 text-text-light dark:text-text-dark">Minutos por Bolsa</p>
                                    <input id="maoDeObraMinutosPorBolsa" class="form-input h-14 w-full ... " inputmode="numeric" placeholder="0" type="number" value="0" oninput="calcularTudo()">
                                </label>
                            </div>
                        </div>

                        <h3 class="text-text-secondary-light dark:text-text-secondary-dark text-sm font-semibold uppercase tracking-wider mb-2 mt-6">Custos Fixos (Rateio Mensal)</h3>
                        <div class="flex flex-col gap-4">
                            <label class="flex flex-col">
                                <p class="text-base font-medium leading-normal pb-2 text-text-light dark:text-text-dark">Produção Mensal Estimada (un)</p>
                                <input id="producaoMensalEstimada" class="form-input h-14 w-full ... " inputmode="numeric" placeholder="100" type="number" value="100" oninput="calcularTudo()">
                            </label>
                            <div class="grid grid-cols-2 gap-4">
                                <label class="flex flex-col">
                                    <p class="text-base font-medium leading-normal pb-2 text-text-light dark:text-text-dark">Aluguel (R$)</p>
                                    <input id="custoAluguel" class="form-input h-14 w-full ... " inputmode="decimal" placeholder="0,00" type="number" value="0" oninput="calcularTudo()">
                                </label>
                                <label class="flex flex-col">
                                    <p class="text-base font-medium leading-normal pb-2 text-text-light dark:text-text-dark">Luz (R$)</p>
                                    <input id="custoLuz" class="form-input h-14 w-full ... " inputmode="decimal" placeholder="0,00" type="number" value="0" oninput="calcularTudo()">
                                </label>
                                <label class="flex flex-col">
                                    <p class="text-base font-medium leading-normal pb-2 text-text-light dark:text-text-dark">Internet (R$)</p>
                                    <input id="custoInternet" class="form-input h-14 w-full ... " inputmode="decimal" placeholder="0,00" type="number" value="0" oninput="calcularTudo()">
                                </label>
                                <label class="flex flex-col">
                                    <p class="text-base font-medium leading-normal pb-2 text-text-light dark:text-text-dark">Manutenção (R$)</p>
                                    <input id="custoManutencao" class="form-input h-14 w-full ... " inputmode="decimal" placeholder="0,00" type="number" value="0" oninput="calcularTudo()">
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="tab-custos" class="tab-panel hidden p-4 space-y-6">
                <div class="p-4 @container">
                    <div class="flex flex-col items-center justify-center rounded-xl bg-primary shadow-lg p-6 text-center">
                        <p class="text-white/80 text-base font-medium leading-normal">Custo Total por Bolsa</p>
                        <p id="outCustoTotal" class="text-white text-4xl font-bold leading-tight tracking-tighter mt-1">R$ 0,00</p>
                    </div>
                </div>
                <div class="px-4">
                    <h2 class="text-slate-500 dark:text-slate-400 text-sm font-semibold uppercase tracking-wider mb-3">Detalhamento de Custos</h2>
                    <div class="flex flex-col gap-2 rounded-xl bg-white dark:bg-slate-900/50 shadow-sm overflow-hidden p-2">
                        <div class="flex items-center gap-4 px-4 py-3 min-h-14 justify-between">
                            <div class="flex items-center gap-4">
                                <div class="text-slate-600 dark:text-slate-300 flex items-center justify-center rounded-lg bg-slate-100 dark:bg-slate-800 shrink-0 size-10">
                                    <span class="material-symbols-outlined text-2xl">category</span>
                                </div>
                                <p class="text-slate-800 dark:text-slate-100 text-base font-medium leading-normal flex-1 truncate">Custo Alça</p>
                            </div>
                            <div class="shrink-0">
                                <p id="outCustoAlca" class="text-slate-800 dark:text-slate-100 text-base font-medium leading-normal">R$ 0,00</p>
                            </div>
                        </div>
                        
                        <div class="flex flex-col px-4 py-3 min-h-14">
                            <div class="flex items-center gap-4 justify-between">
                                <div class="flex items-center gap-4">
                                    <div class="text-slate-600 dark:text-slate-300 flex items-center justify-center rounded-lg bg-slate-100 dark:bg-slate-800 shrink-0 size-10">
                                        <span class="material-symbols-outlined text-2xl">texture</span>
                                    </div>
                                    <p class="text-slate-800 dark:text-slate-100 text-base font-medium leading-normal flex-1 truncate">Custo TNT</p>
                                </div>
                                <div class="shrink-0">
                                    <p id="outCustoTNT" class="text-slate-800 dark:text-slate-100 text-base font-medium leading-normal">R$ 0,00</p>
                                </div>
                            </div>
                            <div class="mt-3">
                                <p class="text-sm font-medium text-slate-600 dark:text-slate-400 mb-2">Aproveitamento do TNT:</p>
                                <div id="vis-tnt-container" class="visual-fabric">
                                    </div>
                                <p id="vis-tnt-label" class="text-sm text-slate-500 dark:text-slate-400 mt-2 text-center">Calculando...</p>
                            </div>
                        </div>

                        <div class="flex flex-col px-4 py-3 min-h-14">
                            <div class="flex items-center gap-4 justify-between">
                                <div class="flex items-center gap-4">
                                    <div class="text-slate-600 dark:text-slate-300 flex items-center justify-center rounded-lg bg-slate-100 dark:bg-slate-800 shrink-0 size-10">
                                        <span class="material-symbols-outlined text-2xl">grid_on</span>
                                    </div>
                                    <p class="text-slate-800 dark:text-slate-100 text-base font-medium leading-normal flex-1 truncate">Custo Algodão</p>
                                </div>
                                <div class="shrink-0">
                                    <p id="outCustoAlgodao" class="text-slate-800 dark:text-slate-100 text-base font-medium leading-normal">R$ 0,00</p>
                                </div>
                            </div>
                            <div class="mt-3">
                                <p class="text-sm font-medium text-slate-600 dark:text-slate-400 mb-2">Aproveitamento do Algodão:</p>
                                <div id="vis-algodao-container" class="visual-fabric">
                                    </div>
                                <p id="vis-algodao-label" class="text-sm text-slate-500 dark:text-slate-400 mt-2 text-center">Calculando...</p>
                            </div>
                        </div>

                        <div class="flex items-center gap-4 px-4 py-3 min-h-14 justify-between">
                            <div class="flex items-center gap-4">
                                <div class="text-slate-600 dark:text-slate-300 flex items-center justify-center rounded-lg bg-slate-100 dark:bg-slate-800 shrink-0 size-10">
                                    <span class="material-symbols-outlined text-2xl">label</span>
                                </div>
                                <p class="text-slate-800 dark:text-slate-100 text-base font-medium leading-normal flex-1 truncate">Custos (Etiq./Emb./Tinta)</p>
                            </div>
                            <div class="shrink-0">
                                <p id="outCustoVariavelExtra" class="text-slate-800 dark:text-slate-100 text-base font-medium leading-normal">R$ 0,00</p>
                            </div>
                        </div>
                        <div class="flex items-center gap-4 px-4 py-3 min-h-14 justify-between">
                            <div class="flex items-center gap-4">
                                <div class="text-slate-600 dark:text-slate-300 flex items-center justify-center rounded-lg bg-slate-100 dark:bg-slate-800 shrink-0 size-10">
                                    <span class="material-symbols-outlined text-2xl">engineering</span>
                                </div>
                                <p class="text-slate-800 dark:text-slate-100 text-base font-medium leading-normal flex-1 truncate">Custo Mão de Obra</p>
                            </div>
                            <div class="shrink-0">
                                <p id="outCustoMaoDeObra" class="text-slate-800 dark:text-slate-100 text-base font-medium leading-normal">R$ 0,00</p>
                            </div>
                        </div>
                        <div class="flex items-center gap-4 px-4 py-3 min-h-14 justify-between">
                            <div class="flex items-center gap-4">
                                <div class="text-slate-600 dark:text-slate-300 flex items-center justify-center rounded-lg bg-slate-100 dark:bg-slate-800 shrink-0 size-10">
                                    <span class="material-symbols-outlined text-2xl">home_work</span>
                                </div>
                                <p class="text-slate-800 dark:text-slate-100 text-base font-medium leading-normal flex-1 truncate">Rateio Custo Fixo</p>
                            </div>
                            <div class="shrink-0">
                                <p id="outCustoFixoRateado" class="text-slate-800 dark:text-slate-100 text-base font-medium leading-normal">R$ 0,00</p>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

            <div id="tab-producao" class="tab-panel hidden p-4">
                <div class="flex flex-col gap-2">
                    <label class="text-base font-medium text-text-light-primary dark:text-text-dark-primary" for="quantity">Quantas bolsas você quer produzir?</label>
                    <input id="metaProducao" class="form-input h-14 w-full rounded-xl border border-border-light bg-surface-light p-4 text-base text-text-light-primary placeholder:text-text-light-secondary focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20 dark:border-border-dark dark:bg-surface-dark dark:text-text-dark-primary dark:placeholder:text-text-dark-secondary dark:focus:border-primary"
                           placeholder="Ex: 50" type="number" value="30" oninput="calcularTudo()" />
                </div>
                <h2 class="pb-2 pt-8 text-lg font-bold tracking-tight text-text-light-primary dark:text-text-dark-primary">Lista de Compras (Materiais)</h2>
                <div class="flex flex-col divide-y divide-border-light overflow-hidden rounded-xl border border-border-light bg-surface-light dark:divide-border-dark dark:border-border-dark dark:bg-surface-dark">
                    <div class="flex min-h-[3.5rem] items-center justify-between gap-4 p-4">
                        <div class="flex items-center gap-4">
                            <div class="flex size-10 shrink-0 items-center justify-center rounded-lg bg-background-light dark:bg-background-dark">
                                <span class="material-symbols-outlined text-2xl text-text-light-secondary dark:text-text-dark-secondary">straighten</span>
                            </div>
                            <p class="flex-1 truncate text-base text-text-light-primary dark:text-text-dark-primary">Metros a comprar (Alça)</p>
                        </div>
                        <p id="outMetaAlca" class="shrink-0 text-base font-medium text-text-light-primary dark:text-text-dark-primary">0 m</p>
                    </div>
                    <div class="flex min-h-[3.5rem] items-center justify-between gap-4 p-4">
                        <div class="flex items-center gap-4">
                            <div class="flex size-10 shrink-0 items-center justify-center rounded-lg bg-background-light dark:bg-background-dark">
                                <span class="material-symbols-outlined text-2xl text-text-light-secondary dark:text-text-dark-secondary">texture</span>
                            </div>
                            <p class="flex-1 truncate text-base text-text-light-primary dark:text-text-dark-primary">Metros a comprar (TNT)</p>
                        </div>
                        <p id="outMetaTNT" class="shrink-0 text-base font-medium text-text-light-primary dark:text-text-dark-primary">0 m</p>
                    </div>
                    <div class="flex min-h-[3.5rem] items-center justify-between gap-4 p-4">
                        <div class="flex items-center gap-4">
                            <div class="flex size-10 shrink-0 items-center justify-center rounded-lg bg-background-light dark:bg-background-dark">
                                <span class="material-symbols-outlined text-2xl text-text-light-secondary dark:text-text-dark-secondary">grid_on</span>
                            </div>
                            <p class="flex-1 truncate text-base text-text-light-primary dark:text-text-dark-primary">Metros a comprar (Algodão)</p>
                        </div>
                        <p id="outMetaAlgodao" class="shrink-0 text-base font-medium text-text-light-primary dark:text-text-dark-primary">0 m</p>
                    </div>
                </div>
                <div class="mt-8 flex flex-col gap-2 rounded-xl border border-primary/20 bg-primary/10 p-5 dark:border-primary/30 dark:bg-primary/20">
                    <p class="text-base font-medium text-primary dark:text-primary/90">Custo Total da Compra (Materiais)</p>
                    <p id="outCustoTotalCompra" class="text-4xl font-extrabold tracking-tighter text-text-light-primary dark:text-text-dark-primary">R$ 0,00</p>
                </div>
            </div>

            <div id="tab-vendas" class="tab-panel hidden p-4">
                <div class="flex flex-col gap-2">
                    <label class="text-base font-medium text-text-light-primary dark:text-text-dark-primary" for="valorVenda">Valor de Venda Unitário (R$)</label>
                    <input id="valorVenda" class="form-input h-14 w-full rounded-xl border border-border-light bg-surface-light p-4 text-base text-text-light-primary placeholder:text-text-light-secondary focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20 dark:border-border-dark dark:bg-surface-dark dark:text-text-dark-primary dark:placeholder:text-text-dark-secondary dark:focus:border-primary"
                           placeholder="Ex: 35,00" type="number" value="35" oninput="calcularTudo()" />
                </div>
                
                <h2 class="pb-2 pt-8 text-lg font-bold tracking-tight text-text-light-primary dark:text-text-dark-primary">Resumo do Lucro (Baseado na Produção)</h2>
                
                <div class="flex flex-col divide-y divide-border-light overflow-hidden rounded-xl border border-border-light bg-surface-light dark:divide-border-dark dark:border-border-dark dark:bg-surface-dark">
                    <div class="flex min-h-[3.5rem] items-center justify-between gap-4 p-4">
                        <div class="flex items-center gap-4">
                            <div class="flex size-10 shrink-0 items-center justify-center rounded-lg bg-background-light dark:bg-background-dark">
                                <span class="material-symbols-outlined text-2xl text-text-light-secondary dark:text-text-dark-secondary">inventory</span>
                            </div>
                            <p class="flex-1 truncate text-base text-text-light-primary dark:text-text-dark-primary">Quantidade de Bolsas (Produção)</p>
                        </div>
                        <p id="outMetaVenda" class="shrink-0 text-base font-medium text-text-light-primary dark:text-text-dark-primary">0 un</p>
                    </div>
                    <div class="flex min-h-[3.5rem] items-center justify-between gap-4 p-4">
                        <div class="flex items-center gap-4">
                            <div class="flex size-10 shrink-0 items-center justify-center rounded-lg bg-background-light dark:bg-background-dark">
                                <span class="material-symbols-outlined text-2xl text-text-light-secondary dark:text-text-dark-secondary">shopping_cart</span>
                            </div>
                            <p class="flex-1 truncate text-base text-text-light-primary dark:text-text-dark-primary">Custo Total por Bolsa</g>
                        </div>
                        <p id="outCustoBolsaVenda" class="shrink-0 text-base font-medium text-red-600 dark:text-red-500">R$ 0,00</p>
                    </div>
                    <div class="flex min-h-[3.5rem] items-center justify-between gap-4 p-4">
                        <div class="flex items-center gap-4">
                            <div class="flex size-10 shrink-0 items-center justify-center rounded-lg bg-background-light dark:bg-background-dark">
                                <span class="material-symbols-outlined text-2xl text-text-light-secondary dark:text-text-dark-secondary">savings</span>
                            </div>
                            <p class="flex-1 truncate text-base text-text-light-primary dark:text-text-dark-primary">Lucro por Bolsa</p>
                        </div>
                        <p id="outLucroUnitario" class="shrink-0 text-base font-medium text-green-600 dark:text-green-500">R$ 0,00</p>
                    </div>
                </div>

                <div class="mt-8 flex flex-col gap-2 rounded-xl border border-primary/20 bg-primary/10 p-5 dark:border-primary/30 dark:bg-primary/20">
                    <p class="text-base font-medium text-primary dark:text-primary/90">Lucro Bruto Estimado Total (Produção)</p>
                    <p id="outLucroTotal" class="text-4xl font-extrabold tracking-tighter text-text-light-primary dark:text-text-dark-primary">R$ 0,00</p>
                </div>
            </div>
            
            <div id="tab-orcamento" class="tab-panel hidden p-4 space-y-6">
                
                <h2 class="pb-2 pt-2 text-lg font-bold tracking-tight text-text-light-primary dark:text-text-dark-primary">Resumo do Pedido (Cliente)</h2>
                <div class="flex flex-col divide-y divide-border-light overflow-hidden rounded-xl border border-border-light bg-surface-light dark:divide-border-dark dark:border-border-dark dark:bg-surface-dark">
                    <div class="flex min-h-[3.5rem] items-center justify-between gap-4 p-4">
                        <div class="flex items-center gap-4">
                            <div class="flex size-10 shrink-0 items-center justify-center rounded-lg bg-background-light dark:bg-background-dark">
                                <span class="material-symbols-outlined text-2xl text-text-light-secondary dark:text-text-dark-secondary">inventory</span>
                            </div>
                            <p class="flex-1 truncate text-base text-text-light-primary dark:text-text-dark-primary">Quantidade de Bolsas</p>
                        </div>
                        <p id="outOrcamentoQuantidade" class="shrink-0 text-base font-medium text-text-light-primary dark:text-text-dark-primary">0 un</p>
                    </div>
                    <div class="flex min-h-[3.5rem] items-center justify-between gap-4 p-4">
                        <div class="flex items-center gap-4">
                            <div class="flex size-10 shrink-0 items-center justify-center rounded-lg bg-background-light dark:bg-background-dark">
                                <span class="material-symbols-outlined text-2xl text-text-light-secondary dark:text-text-dark-secondary">sell</span>
                            </div>
                            <p class="flex-1 truncate text-base text-text-light-primary dark:text-text-dark-primary">Valor Unitário (Venda)</p>
                        </div>
                        <p id="outOrcamentoPrecoUnitario" class="shrink-0 text-base font-medium text-text-light-primary dark:text-text-dark-primary">R$ 0,00</p>
                    </div>
                    <div class="flex min-h-[3.5rem] items-center justify-between gap-4 p-4">
                        <div class="flex items-center gap-4">
                            <div class="flex size-10 shrink-0 items-center justify-center rounded-lg bg-background-light dark:bg-background-dark">
                                <span class="material-symbols-outlined text-2xl text-text-light-secondary dark:text-text-dark-secondary">receipt_long</span>
                            </div>
                            <p class="flex-1 truncate text-base font-medium text-text-light-primary dark:text-text-dark-primary">Subtotal (Produtos)</p>
                        </div>
                        <p id="outOrcamentoSubtotal" class="shrink-0 text-base font-bold text-text-light-primary dark:text-text-dark-primary">R$ 0,00</p>
                    </div>
                </div>

                <div class="flex flex-col gap-4">
                    <label class="flex flex-col">
                        <p class="text-base font-medium leading-normal pb-2 text-text-light dark:text-text-dark">Valor do Frete (R$)</p>
                        <input id="orcamentoFrete" class="form-input h-14 w-full ... " inputmode="decimal" placeholder="0,00" type="number" value="0" oninput="calcularTudo()">
                    </label>
                    <label class="flex flex-col">
                        <p class="text-base font-medium leading-normal pb-2 text-text-light dark:text-text-dark">Taxa de Urgência (R$)</p>
                        <input id="orcamentoTaxaUrgencia" class="form-input h-14 w-full ... " inputmode="decimal" placeholder="0,00" type="number" value="0" oninput="calcularTudo()">
                    </label>
                </div>
                
                <div class="mt-4 flex flex-col gap-2 rounded-xl border-2 border-primary p-5 dark:border-primary">
                    <p class="text-base font-medium text-primary dark:text-primary/90">Valor Total do Orçamento</p>
                    <p id="outOrcamentoTotal" class="text-4xl font-extrabold tracking-tighter text-text-light-primary dark:text-text-dark-primary">R$ 0,00</p>
                </div>

                <h2 class="pb-2 pt-4 text-lg font-bold tracking-tight text-text-light-primary dark:text-text-dark-primary">Resumo de Materiais (Referência)</h2>
                <div class="flex flex-col divide-y divide-border-light overflow-hidden rounded-xl border border-border-light bg-surface-light dark:divide-border-dark dark:border-border-dark dark:bg-surface-dark">
                    <div class="flex min-h-[3.5rem] items-center justify-between gap-4 p-4">
                        <p class="flex-1 truncate text-base text-text-light-primary dark:text-text-dark-primary">Alça (por bolsa)</p>
                        <p id="outOrcamentoAlca" class="shrink-0 text-base font-medium text-text-secondary-light dark:text-text-secondary-dark">0 cm</p>
                    </div>
                    <div class="flex min-h-[3.5rem] items-center justify-between gap-4 p-4">
                        <p class="flex-1 truncate text-base text-text-light-primary dark:text-text-dark-primary">Peça TNT (A x L)</p>
                        <p id="outOrcamentoTNT" class="shrink-0 text-base font-medium text-text-secondary-light dark:text-text-secondary-dark">0cm x 0cm</p>
                    </div>
                    <div class="flex min-h-[3.5rem] items-center justify-between gap-4 p-4">
                        <p class="flex-1 truncate text-base text-text-light-primary dark:text-text-dark-primary">Peça Algodão (A x L)</p>
                        <p id="outOrcamentoAlgodao" class="shrink-0 text-base font-medium text-text-secondary-light dark:text-text-secondary-dark">0cm x 0cm</p>
                    </div>
                </div>

            </div>

        </main>

        <footer class="fixed bottom-0 z-10 w-full border-t border-border-light/80 bg-background-light/80 dark:border-border-dark/80 dark:bg-background-dark/80 pb-safe backdrop-blur-sm">
            <nav class="grid h-[72px] grid-cols-5 px-2"> 
                <a id="nav-insumos" class="nav-link flex flex-col items-center justify-center gap-1.5 text-primary" href="#" data-tab="insumos">
                    <span class="material-symbols-outlined text-2xl filled">widgets</span>
                    <span class="text-xs font-bold">Insumos</span>
                </a>
                <a id="nav-custos" class="nav-link flex flex-col items-center justify-center gap-1.5 text-text-secondary-light dark:text-text-secondary-dark" href="#" data-tab="custos">
                    <span class="material-symbols-outlined text-2xl">request_quote</span>
                    <span class="text-xs font-medium">Custos</span>
                </a>
                <a id="nav-producao" class="nav-link flex flex-col items-center justify-center gap-1.5 text-text-secondary-light dark:text-text-secondary-dark" href="#" data-tab="producao">
                    <span class="material-symbols-outlined text-2xl">inventory_2</span>
                    <span class="text-xs font-medium">Produção</span>
                </a>
                <a id="nav-vendas" class="nav-link flex flex-col items-center justify-center gap-1.5 text-text-secondary-light dark:text-text-secondary-dark" href="#" data-tab="vendas">
                    <span class="material-symbols-outlined text-2xl">trending_up</span>
                    <span class="text-xs font-medium">Vendas</span>
                </a>
                <a id="nav-orcamento" class="nav-link flex flex-col items-center justify-center gap-1.5 text-text-secondary-light dark:text-text-secondary-dark" href="#" data-tab="orcamento">
                    <span class="material-symbols-outlined text-2xl">receipt_long</span>
                    <span class="text-xs font-medium">Orçamento</span>
                </a>
            </nav>
        </footer>
    </div>

    <script>
        // --- FUNÇÕES HELPER ---

        function formatarMoeda(valor) {
            return valor.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
        }

        function lerFloat(id) {
            const el = document.getElementById(id);
            if (!el) return 0;
            return parseFloat(el.value) || 0;
        }

        function escreverValor(id, valor, tipo = 'moeda') {
            const el = document.getElementById(id);
            if (!el) return;
            
            if (tipo === 'moeda') {
                el.textContent = formatarMoeda(valor);
            } else if (tipo === 'metro') {
                el.textContent = valor.toFixed(2) + ' m';
            } else if (tipo === 'unidade') {
                el.textContent = valor.toString() + ' un';
            } else if (tipo === 'texto') {
                el.textContent = valor.toString();
            } else {
                el.textContent = valor.toString();
            }
        }
        
        const titulosAbas = {
            insumos: "Custos de Insumos",
            custos: "Análise de Custos",
            producao: "Calculadora de Produção",
            vendas: "Planejamento de Venda",
            orcamento: "Orçamento para Cliente"
        };

        // --- LÓGICA DE NAVEGAÇÃO ---

        function atualizarVisibilidadeMaoDeObra() {
            const tipo = document.getElementById('tipoCalculoMaoDeObra').value;
            const divFixo = document.getElementById('div-mao-obra-fixo');
            const divHora = document.getElementById('div-mao-obra-hora');

            if (tipo === 'fixo') {
                divFixo.classList.remove('hidden');
                divHora.classList.add('hidden');
            } else { // 'hora'
                divFixo.classList.add('hidden');
                divHora.classList.remove('hidden');
            }
            calcularTudo();
        }

        function ativarAba(tabId) {
            document.querySelectorAll('.tab-panel').forEach(panel => {
                panel.classList.add('hidden');
            });
            const newTab = document.getElementById(`tab-${tabId}`);
            if(newTab) newTab.classList.remove('hidden');

            if(titulosAbas[tabId]) {
                document.getElementById('header-title').textContent = titulosAbas[tabId];
            }

            document.querySelectorAll('.nav-link').forEach(link => {
                const linkIcon = link.querySelector('.material-symbols-outlined');
                const linkLabel = link.querySelector('span:last-child');

                if (link.dataset.tab === tabId) {
                    link.classList.add('text-primary');
                    link.classList.remove('text-text-secondary-light', 'dark:text-text-secondary-dark');
                    linkIcon.classList.add('filled');
                    linkLabel.classList.add('font-bold');
                    linkLabel.classList.remove('font-medium');
                } else {
                    link.classList.remove('text-primary');
                    link.classList.add('text-text-secondary-light', 'dark:text-text-secondary-dark');
                    linkIcon.classList.remove('filled');
                    linkLabel.classList.remove('font-bold');
                    linkLabel.classList.add('font-medium');
                }
            });
        }

        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const tabId = e.currentTarget.dataset.tab;
                ativarAba(tabId);
            });
        });

        // --- (NOVO) LÓGICA DE OTIMIZAÇÃO DE CORTE ---

        /**
         * Calcula o melhor aproveitamento de tecido, testando duas orientações.
         * @returns {Object} O resultado otimizado.
         */
        function calcularAproveitamento(precoMetro, larguraTecido, alturaPeca, larguraPeca) {
            // Evitar divisão por zero se os valores forem 0
            if (!larguraTecido || !alturaPeca || !larguraPeca) {
                return { custoUnitario: 0, pecasPorLargura: 1, alturaFileira: 0, orientacao: 'inválida' };
            }

            // Teste 1: Orientação "Retrato" (Largura da peça contra Largura do tecido)
            const pecasPorLargura_1 = Math.floor(larguraTecido / larguraPeca);
            let custoUnitario_1 = Infinity;
            if (pecasPorLargura_1 > 0) {
                const custoFileira_1 = (alturaPeca / 100) * precoMetro; // Custo de puxar 'alturaPeca' do rolo
                custoUnitario_1 = custoFileira_1 / pecasPorLargura_1;
            }

            // Teste 2: Orientação "Paisagem" (Altura da peça contra Largura do tecido)
            const pecasPorLargura_2 = Math.floor(larguraTecido / alturaPeca);
            let custoUnitario_2 = Infinity;
            if (pecasPorLargura_2 > 0) {
                const custoFileira_2 = (larguraPeca / 100) * precoMetro; // Custo de puxar 'larguraPeca' do rolo
                custoUnitario_2 = custoFileira_2 / pecasPorLargura_2;
            }

            // Comparar e retornar o melhor resultado
            if (custoUnitario_1 <= custoUnitario_2) {
                return {
                    custoUnitario: custoUnitario_1,
                    pecasPorLargura: pecasPorLargura_1,
                    alturaFileira: alturaPeca, // Comprimento (cm) do rolo usado para esta fileira
                    larguraPecaUsada: larguraPeca, // A dimensão da peça que foi contra a largura do tecido
                    orientacao: 'Padrão (Largura Peça)'
                };
            } else {
                return {
                    custoUnitario: custoUnitario_2,
                    pecasPorLargura: pecasPorLargura_2,
                    alturaFileira: larguraPeca, // Comprimento (cm) do rolo usado para esta fileira
                    larguraPecaUsada: alturaPeca, // A dimensão da peça que foi contra a largura do tecido
                    orientacao: 'Rotacionada (Altura Peça)'
                };
            }
        }

        /**
         * (NOVO) Atualiza a visualização do corte
         */
        function atualizarVisualizacao(containerId, labelId, resultado, larguraTecido) {
            const container = document.getElementById(containerId);
            const label = document.getElementById(labelId);
            if (!container || !label) return;

            // Limpar visualização anterior
            container.innerHTML = '';

            if (!resultado || resultado.pecasPorLargura === 0 || !isFinite(resultado.custoUnitario)) {
                label.textContent = 'Dimensões inválidas para o corte.';
                return;
            }

            // Desenhar as peças
            const larguraTotalUsada = resultado.pecasPorLargura * resultado.larguraPecaUsada;
            const sobra = larguraTecido - larguraTotalUsada;

            for (let i = 0; i < resultado.pecasPorLargura; i++) {
                const piece = document.createElement('div');
                piece.className = 'visual-piece';
                // Usar porcentagem para o visual
                piece.style.width = `${(resultado.larguraPecaUsada / larguraTecido) * 100}%`;
                piece.textContent = `${resultado.larguraPecaUsada}cm`;
                container.appendChild(piece);
            }

            // Atualizar label
            label.textContent = `Orientação: ${resultado.orientacao} (${resultado.larguraPecaUsada}cm). Cabem ${resultado.pecasPorLargura} peças. (Sobra: ${sobra.toFixed(1)}cm)`;
        }


        // --- LÓGICA PRINCIPAL DE CÁLCULO ---
        
        // (NOVO) Armazena os resultados da otimização para usar na aba 'Produção'
        let resultadoOtimizadoTNT = {};
        let resultadoOtimizadoAlgodao = {};

        function calcularTudo() {
            // --- 1. LER TODOS OS INPUTS ---
            
            // Materiais
            const precoAlca = lerFloat('precoAlca');
            const cmAlca = lerFloat('cmAlca');
            const precoTNT = lerFloat('precoTNT');
            const larguraTNT = lerFloat('larguraTNT');
            const alturaPecaTNT = lerFloat('alturaPecaTNT');
            const larguraPecaTNT = lerFloat('larguraPecaTNT');
            const precoAlgodao = lerFloat('precoAlgodao');
            const larguraAlgodao = lerFloat('larguraAlgodao');
            const alturaPecaAlgodao = lerFloat('alturaPecaAlgodao');
            const larguraPecaAlgodao = lerFloat('larguraPecaAlgodao');
            
            // Custos Variáveis Extras
            const precoEtiqueta = lerFloat('precoEtiqueta');
            const precoEmbalagem = lerFloat('precoEmbalagem');
            const precoTinta = lerFloat('precoTinta');

            // Mão de Obra
            const tipoCalculoMaoDeObra = document.getElementById('tipoCalculoMaoDeObra').value;
            const maoDeObraFixo = lerFloat('maoDeObraFixo');
            const maoDeObraValorHora = lerFloat('maoDeObraValorHora');
            const maoDeObraMinutosPorBolsa = lerFloat('maoDeObraMinutosPorBolsa');

            // Custos Fixos
            const producaoMensalEstimada = lerFloat('producaoMensalEstimada') || 1;
            const custoAluguel = lerFloat('custoAluguel');
            const custoLuz = lerFloat('custoLuz');
            const custoInternet = lerFloat('custoInternet');
            const custoManutencao = lerFloat('custoManutencao');

            // Produção e Vendas
            const metaProducao = lerFloat('metaProducao');
            const valorVenda = lerFloat('valorVenda');
            
            // Orçamento
            const orcamentoFrete = lerFloat('orcamentoFrete');
            const orcamentoTaxaUrgencia = lerFloat('orcamentoTaxaUrgencia');


            // --- 2. CALCULAR CUSTOS UNITÁRIOS (Aba "Custos") ---

            // Custo Materiais
            const custoUnitarioAlca = (cmAlca / 100) * precoAlca;
            
            // (NOVO) Cálculo Otimizado
            resultadoOtimizadoTNT = calcularAproveitamento(precoTNT, larguraTNT, alturaPecaTNT, larguraPecaTNT);
            const custoUnitarioTNT = resultadoOtimizadoTNT.custoUnitario;
            
            resultadoOtimizadoAlgodao = calcularAproveitamento(precoAlgodao, larguraAlgodao, alturaPecaAlgodao, larguraPecaAlgodao);
            const custoUnitarioAlgodao = resultadoOtimizadoAlgodao.custoUnitario;

            // Custo Variável Extra
            const custoUnitarioVariavelExtra = precoEtiqueta + precoEmbalagem + precoTinta;
            
            // Custo Mão de Obra
            let custoUnitarioMaoDeObra = 0;
            if (tipoCalculoMaoDeObra === 'fixo') {
                custoUnitarioMaoDeObra = maoDeObraFixo;
            } else {
                custoUnitarioMaoDeObra = (maoDeObraValorHora / 60) * maoDeObraMinutosPorBolsa;
            }

            // Custo Fixo Rateado
            const totalCustosFixosMensais = custoAluguel + custoLuz + custoInternet + custoManutencao;
            const custoUnitarioFixoRateado = totalCustosFixosMensais / producaoMensalEstimada;

            // Custo Total
            const custoTotalPorBolsa = custoUnitarioAlca + 
                                       custoUnitarioTNT + 
                                       custoUnitarioAlgodao + 
                                       custoUnitarioVariavelExtra + 
                                       custoUnitarioMaoDeObra + 
                                       custoUnitarioFixoRateado;

            // --- 3. ATUALIZAR ABA "Custos" ---
            escreverValor('outCustoAlca', custoUnitarioAlca, 'moeda');
            escreverValor('outCustoTNT', custoUnitarioTNT, 'moeda');
            escreverValor('outCustoAlgodao', custoUnitarioAlgodao, 'moeda');
            escreverValor('outCustoVariavelExtra', custoUnitarioVariavelExtra, 'moeda');
            escreverValor('outCustoMaoDeObra', custoUnitarioMaoDeObra, 'moeda');
            escreverValor('outCustoFixoRateado', custoUnitarioFixoRateado, 'moeda');
            escreverValor('outCustoTotal', custoTotalPorBolsa, 'moeda');
            
            // (NOVO) Atualizar Visualizações
            atualizarVisualizacao('vis-tnt-container', 'vis-tnt-label', resultadoOtimizadoTNT, larguraTNT);
            atualizarVisualizacao('vis-algodao-container', 'vis-algodao-label', resultadoOtimizadoAlgodao, larguraAlgodao);


            // --- 4. CALCULAR LISTA DE COMPRAS (Aba "Produção") ---
            // Usa os resultados otimizados
            
            const metrosAlcaComprar = metaProducao * (cmAlca / 100);
            
            const fileirasTNTComprar = Math.ceil(metaProducao / (resultadoOtimizadoTNT.pecasPorLargura || 1));
            const metrosTNTComprar = fileirasTNTComprar * (resultadoOtimizadoTNT.alturaFileira / 100);
            
            const fileirasAlgodaoComprar = Math.ceil(metaProducao / (resultadoOtimizadoAlgodao.pecasPorLargura || 1));
            const metrosAlgodaoComprar = fileirasAlgodaoComprar * (resultadoOtimizadoAlgodao.alturaFileira / 100);

            // Custo Total da Compra (Apenas Materiais)
            const custoMetaAlca = metrosAlcaComprar * precoAlca;
            const custoMetaTNT = metrosTNTComprar * precoTNT;
            const custoMetaAlgodao = metrosAlgodaoComprar * precoAlgodao;
            const custoTotalMeta = custoMetaAlca + custoMetaTNT + custoMetaAlgodao;

            // --- 5. ATUALIZAR ABA "Produção" ---
            escreverValor('outMetaAlca', metrosAlcaComprar, 'metro');
            escreverValor('outMetaTNT', metrosTNTComprar, 'metro');
            escreverValor('outMetaAlgodao', metrosAlgodaoComprar, 'metro');
            escreverValor('outCustoTotalCompra', custoTotalMeta, 'moeda');

            // --- 6. CALCULAR LUCRO (Aba "Vendas") ---
            const lucroBrutoUnitario = valorVenda - custoTotalPorBolsa;
            const lucroBrutoTotal = lucroBrutoUnitario * metaProducao;

            // --- 7. ATUALIZAR ABA "Vendas" ---
            escreverValor('outMetaVenda', metaProducao, 'unidade');
            escreverValor('outCustoBolsaVenda', custoTotalPorBolsa, 'moeda');
            // LINHA 842 (CORRIGIDA - "E" REMOVIDO)
            escreverValor('outLucroUnitario', lucroBrutoUnitario, 'moeda');
            escreverValor('outLucroTotal', lucroBrutoTotal, 'moeda');

            // --- 8. CALCULAR E ATUALIZAR ABA "Orçamento" ---
            const subtotalOrcamento = metaProducao * valorVenda;
            const totalOrcamento = subtotalOrcamento + orcamentoFrete + orcamentoTaxaUrgencia;
            
            escreverValor('outOrcamentoQuantidade', metaProducao, 'unidade');
            escreverValor('outOrcamentoPrecoUnitario', valorVEda, 'moeda');
            escreverValor('outOrcamentoSubtotal', subtotalOrcamento, 'moeda');
            escreverValor('outOrcamentoTotal', totalOrcamento, 'moeda');

            // Resumo de Materiais no Orçamento
            escreverValor('outOrcamentoAlca', cmAlca + ' cm', 'texto');
            escreverValor('outOrcamentoTNT', `${alturaPecaTNT}cm x ${larguraPecaTNT}cm`, 'texto');
            escreverValor('outOrcamentoAlgodao', `${alturaPecaAlgodao}cm x ${larguraPecaAlgodao}cm`, 'texto');
        }

        // --- INICIALIZAÇÃO ---
        window.onload = () => {
            ativarAba('insumos');
            atualizarVisibilidadeMaoDeObra();
            calcularTudo();
        };

    </script>
</body>
</html>
